SELECT 
  Country_Name,
  Country_Code,
  SUM(CASE WHEN Year_2003 IS NULL THEN 1 ELSE 0 END) AS Missing_2003,
  SUM(CASE WHEN Year_2004 IS NULL THEN 1 ELSE 0 END) AS Missing_2004,
  SUM(CASE WHEN Year_2005 IS NULL THEN 1 ELSE 0 END) AS Missing_2005,
  SUM(CASE WHEN Year_2006 IS NULL THEN 1 ELSE 0 END) AS Missing_2006,
  SUM(CASE WHEN Year_2007 IS NULL THEN 1 ELSE 0 END) AS Missing_2007,
  SUM(CASE WHEN Year_2008 IS NULL THEN 1 ELSE 0 END) AS Missing_2008,
  SUM(CASE WHEN Year_2009 IS NULL THEN 1 ELSE 0 END) AS Missing_2009,
  SUM(CASE WHEN Year_2010 IS NULL THEN 1 ELSE 0 END) AS Missing_2010,
  SUM(CASE WHEN Year_2011 IS NULL THEN 1 ELSE 0 END) AS Missing_2011,
  SUM(CASE WHEN Year_2012 IS NULL THEN 1 ELSE 0 END) AS Missing_2012,
  SUM(CASE WHEN Year_2013 IS NULL THEN 1 ELSE 0 END) AS Missing_2013,
  SUM(CASE WHEN Year_2014 IS NULL THEN 1 ELSE 0 END) AS Missing_2014,
  SUM(CASE WHEN Year_2015 IS NULL THEN 1 ELSE 0 END) AS Missing_2015,
  SUM(CASE WHEN Year_2016 IS NULL THEN 1 ELSE 0 END) AS Missing_2016,
  SUM(CASE WHEN Year_2017 IS NULL THEN 1 ELSE 0 END) AS Missing_2017,
  SUM(CASE WHEN Year_2018 IS NULL THEN 1 ELSE 0 END) AS Missing_2018,
  SUM(CASE WHEN Year_2019 IS NULL THEN 1 ELSE 0 END) AS Missing_2019,
  SUM(CASE WHEN Year_2020 IS NULL THEN 1 ELSE 0 END) AS Missing_2020,
  SUM(CASE WHEN Year_2021 IS NULL THEN 1 ELSE 0 END) AS Missing_2021,
  COUNTIF(Year_2003 IS NULL OR Year_2004 IS NULL OR Year_2005 IS NULL 
          OR Year_2006 IS NULL OR Year_2007 IS NULL OR Year_2008 IS NULL 
          OR Year_2009 IS NULL OR Year_2010 IS NULL OR Year_2011 IS NULL 
          OR Year_2012 IS NULL OR Year_2013 IS NULL OR Year_2014 IS NULL 
          OR Year_2015 IS NULL OR Year_2016 IS NULL OR Year_2017 IS NULL 
          OR Year_2018 IS NULL OR Year_2019 IS NULL OR Year_2020 IS NULL 
          OR Year_2021 IS NULL) AS Total_Missing_Years
FROM `fa24-i535-vpawar-gdphealthcare.gdp_healthcare_analysis.healthcare_exp3`
GROUP BY Country_Name, Country_Code
ORDER BY Total_Missing_Years DESC;
